<!DOCTYPE html>
<html lang="en" class="no-js">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
  <link rel="stylesheet" href="/bower_components/angular-material/angular-material.css">
  <link href="/bower_components/md-color-picker/dist/mdColorPicker.min.css" rel="stylesheet" />
  <title>MEAN johnny-five and socket.io</title>
</head>

<body>
  <script src="/bower_components/socket.io-client/socket.io.js"></script>
  <script src="/bower_components/angular/angular.js"></script>
  <script src="/bower_components/angular-socket-io/socket.js"></script>
  <script src="/bower_components/angular-aria/angular-aria.js"></script>
  <script src="/bower_components/angular-animate/angular-animate.js"></script>
  <script src="/bower_components/angular-material/angular-material.js"></script>
  <script src="/bower_components/tinycolor/dist/tinycolor-min.js"></script>
  <script src="/bower_components/md-color-picker/dist/mdColorPicker.min.js"></script>

  <div ng-app="myApp" ng-controller="ArduController">
    <md-toolbar md-scroll-shrink ng-if="true" ng-controller="ArduController">
      <div class="md-toolbar-tools">
        <h1 class="md-display-2">Demo: Tying it all together</h1>
      </div>
    </md-toolbar>
    <md-tabs md-dynamic-height md-border-bottom>
      <md-tab label="Board Commands">
        <md-content class="md-padding">
          <h2 class="md-display-2">Fubarino Mini - LED</h2>
          <button ng-click="ledOn()">On</button>
          <button ng-click="ledOff()">Off</button>
        </md-content>
      </md-tab>
      <md-tab label="LED Commands">
        <md-content class="md-padding">
          <h2 class="md-display-2">Ledstrip Commands</h2>
          <button ng-click="clear()">clear()</button>
          <button ng-click="show()">show()</button>
          <button ng-click="ledstriphello()">ledstriphello()</button>
          <button ng-click="ledstripsetpixelcolor(3, 255, 255, 255)">ledstripsetpixel()</button>
        </md-content>
      </md-tab>
      <md-tab label="Temperature">
        <md-content class="md-padding">
          <h2 class="md-display-2">Temperature  Commands</h2>
          <button ng-click="setLowAlarm()">setLowAlarm()</button>
          <button ng-click="setHighAlarm()">setHighAlarm()</button>
          <div>Current Temp:</div>
          <div>min Temp:</div>
          <div>Max Temp:</div>
        </md-content>
      </md-tab>
      <md-tab label="LED Mixing">
        <h2 class="md-display-2">RGB Pixels and Sliders</h2>
        <md-slider-container flex>
          <md-input-container>
            <input flex type="number" ng-model="pix" aria-label="pixels" aria-controls="pixel-slider">
          </md-input-container>
          <md-slider ng-model="pix" ng-change="updatePixels(pix)" min="0" max="29" aria-label="pixels" id="pixel-slider" class="md-primary" md-vertical md-range></md-slider>
        </md-slider-container>
        <md-slider-container>
          <span class="md-body-1">Red</span>
          <md-slider  class="md-accent md-hue-1"  flex min="0" max="255" ng-model="color.red" ng-change="updateColor()" aria-label="red" id="red-slider">
          </md-slider>
          <md-input-container>
            <input flex type="number" ng-model="color.red" aria-label="red" aria-controls="red-slider">
          </md-input-container>
        </md-slider-container>
        <md-slider-container>
          <span class="md-body-1">Green</span>
          <md-slider class="md-accent" flex ng-model="color.green" ng-change="updateColor()" min="0" max="255" aria-label="green" id="green-slider" md-colors="{color: 'green-A100'}" class="md-accent">
          </md-slider>
          <md-input-container>
            <input flex type="number" ng-model="color.green" aria-label="green" aria-controls="green-slider">
          </md-input-container>
        </md-slider-container>
        <md-slider-container>
          <span class="md-body-1">Blue</span>
          <md-slider class="md-accent" flex ng-model="color.blue" ng-change="updateColor()" min="0" max="255" aria-label="blue" id="blue-slider">
          </md-slider>
          <md-input-container>
            <input flex type="number" ng-model="color.blue" aria-label="blue" aria-controls="blue-slider">
          </md-input-container>
        </md-slider-container>
        <div md-color-picker="colorPicker.options" ng-model="colorPicker.color"></div>
      </md-tab>
    </md-tabs>

  </div>
  <script type="text/javascript">
    var app = angular.module('myApp', ['btford.socket-io', 'ngMaterial', 'mdColorPicker']).
    config(function($mdThemingProvider) {
      var rgbMap = $mdThemingProvider.extendPalette('green', {
        'hue-2' : '#00ff00',
        'hue-1' : '#ff0000',
        'bbb' : '#0000ff'
      });
      $mdThemingProvider.definePalette('rgb', rgbMap);

      $mdThemingProvider.theme('default')
        .primaryPalette('indigo')
        .accentPalette('rgb');
    }).
    factory('mySocket', function(socketFactory) {
      return socketFactory();
    }).
    controller('ArduController', function($scope, mySocket) {
      $scope.color = {
        red: Math.floor(Math.random() * 255),
        green: Math.floor(Math.random() * 255),
        blue: Math.floor(Math.random() * 255)
      };
      $scope.ledOn = function() {
        mySocket.emit('led:on');
        console.log('LED ON');
      };
      $scope.ledOff = function() {
        mySocket.emit('led:off');
        console.log('LED OFF');
      };
      $scope.clear = function() {
        mySocket.emit('ledstrip:clear');
        console.log('LED STRIP CLEAR');
      };
      $scope.show = function() {
        mySocket.emit('ledstrip:show');
        console.log('LED STRIP SHOW');
      };
      $scope.ledstriphello = function() {
        mySocket.emit('ledstrip:hello');
        console.log('LED STRIP HELLO');
      };
      $scope.updateColor = function(cc) {
        var data = {
          pixel: $scope.pix,
          red: $scope.color.red,
          green: $scope.color.green,
          blue: $scope.color.blue
        }
        mySocket.emit('ledstrip:setpixelcolor', data);
        mySocket.emit('ledstrip:show');

      };
      $scope.updatePixels = function(pixels) {
        var data = {
          pixel: pixels,
          red: $scope.color.red,
          green: $scope.color.green,
          blue: $scope.color.blue
        }
        mySocket.emit('ledstrip:clear');
        mySocket.emit('ledstrip:setpixelcolor', data);
        mySocket.emit('ledstrip:show');

      };
      /*
      	    $scope.colorPicker.options = {
                    label: "Choose a color",
      	      icon: "brush",
                    default: "#ff0000",
                    genericPalette: false,
                    history: false
                   };
      */
    });
  </script>
</body>
